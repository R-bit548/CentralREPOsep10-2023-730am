This is logic A related code

complete logic B related code
